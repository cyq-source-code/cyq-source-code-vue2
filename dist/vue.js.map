{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/gloablAPI.js","../src/compiler/parse.js","../src/compiler/index.js","../src/observe/dep.js","../src/observe/watcher.js","../src/vdom/index.js","../src/lifecycle.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["const strats = {};\nconst LIFECYCLE = [\"beforeCreate\", \"created\"];\nLIFECYCLE.forEach((hook) => {\n  strats[hook] = function (p, c) {\n    // {} {created:function(){}} ===> {created:[fn]}\n    // {created:[fn]} {created:function(){}} ===> {created:[fn,fn]}\n    if (c) {\n      if (p) {\n        // 父亲有,儿子有，合并\n        return p.concat(c);\n      } else {\n        // 儿子有，父亲没有，儿子包装成数组（作为后续父亲）\n        return [c];\n      }\n    } else {\n      // 儿子没有，直接返回父亲\n      return p;\n    }\n  };\n});\nexport function mergeOptions(parent, child) {\n  const options = {};\n  for (let key in parent) {\n    mergeFiled(key);\n  }\n  for (let key in child) {\n    if (!parent.hasOwnProperty(key)) {\n      mergeFiled(key);\n    }\n  }\n  function mergeFiled(key) {\n    // 策略模式 用策略减少 if else 判断\n    if (strats[key]) {\n      options[key] = strats[key](parent[key], child[key]);\n    } else {\n      // 如果不在策略中，以儿子为主\n      options[key] = child[key] || parent[key]; // 优先采用儿子\n    }\n  }\n  return options;\n}\n","import { mergeOptions } from \"./utils\";\n\nexport function initGloablAPI(Vue) {\n  // 静态方法\n  Vue.options = {};\n  Vue.mixin = function (mixin) {\n    // 我们期望将用户的选项 和 全局的 options 进行合并\n    this.options = mergeOptions(this.options, mixin);\n    return this;\n  };\n}\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); //匹配到的分组是一个标签名<xxx匹配到的是开始标签的名字\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //匹配的是</xxxx>最终匹配到的分组就是结束标签的名字\nconst attribute =\n  /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; //匹配属性 //第一个分组就是属性的key value就是分组3/分组4/分组五\nconst startTagClose = /^\\s*(\\/?)>/; //<div><br/>\n\n\nexport function parseHTML(html) {\n  const ELEMENT_TYPE = 1; // 元素类型\n  const TEXT_TYPE = 3; // 文本类型\n  const stack = []; // 栈，存放元素\n  let currentParent; // 指向栈的最后一个元素\n  let root; //根节点\n\n  function createASTElement(tag, attrs) {\n    return {\n      tag,\n      type: ELEMENT_TYPE,\n      children: [],\n      attrs,\n      parent: null,\n    };\n  }\n\n  function start(tag, attrs) {\n    console.log(\"开始标签\", tag, attrs);\n\n    let node = createASTElement(tag, attrs); // 创建一个ast节点\n    if (!root) {\n      // 如果是空树，则当前节点为树的根节点\n      root = node;\n    }\n    if (currentParent) {\n      node.parent = currentParent; // 指定当前元素的父元素\n      currentParent.children.push(node); // 添进父元素的children里\n    }\n    stack.push(node);\n    currentParent = node; // 更新 父元素\n  }\n  function chars(text) {\n    console.log(\"文本内容\", text);\n    // 文本直接放到当前指向的节点\n    text = text.replace(/\\s/g, \"\");\n    text &&\n      currentParent.children.push({\n        type: TEXT_TYPE,\n        text,\n        parent: currentParent,\n      });\n  }\n  function end(tag) {\n    console.log(\"结束标签\", tag);\n    stack.pop(); // 删除最后一个元素\n    currentParent = stack[stack.length - 1]; // 更新 父元素\n  }\n\n  // 逐个匹配，删除匹配过的字符\n  function advance(n) {\n    html = html.substring(n);\n  }\n\n  function parseStartTag() {\n    const start = html.match(startTagOpen);\n    if (start) {\n      const match = {\n        tagName: start[1], // 标签名\n        attrs: [],\n      };\n      advance(start[0].length);\n      // 如果不是开始标签的结束，就一直匹配下去\n      let attr, end;\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        advance(attr[0].length);\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5] || true,\n        });\n      }\n      if (end) {\n        advance(end[0].length);\n      }\n      return match;\n    }\n    return false; // 不是开始标签\n  }\n  while (html) {\n    // 如果textEnd === 0 说明是一个开始标签或者结束标签\n    // 如果textEnd > 0 说明就是文本的结束位置\n    let textEnd = html.indexOf(\"<\"); // 如果是0 说名是个标签\n    if (textEnd === 0) {\n      const startTagMatch = parseStartTag();\n      // 开始标签\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs);\n        continue;\n      }\n\n      const endTagMatch = html.match(endTag);\n      // 结束标签\n      if (endTagMatch) {\n        advance(endTagMatch[0].length);\n        end(endTagMatch[1]);\n        continue;\n      }\n    }\n    if (textEnd > 0) {\n      let text = html.substring(0, textEnd); // 文本内容\n      if (text) {\n        chars(text);\n        advance(text.length);\n      }\n    }\n  }\n  return root;\n}\n","import { parseHTML } from \"./parse\";\nfunction genProps(attrs) {\n  let str = \"\";\n  for (let i = 0; i < attrs.length; i++) {\n    let attr = attrs[i];\n    if (attr.name === \"style\") {\n      let obj = {};\n      attr.value.split(\";\").forEach((item) => {\n        let [key, value] = item.split(\":\");\n        obj[key.trim()] = value.trim();\n      });\n      attr.value = obj;\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\n  }\n  return `{${str.slice(0, -1)}}`;\n}\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; //{asdsadsa}匹配到的内容就是我们表达式的变量\nfunction gen(node) {\n  // 标签\n  if (node.type === 1) {\n    return codegen(node);\n  }\n  // 文本\n  else {\n    let text = node.text;\n    if (!defaultTagRE.test(text)) {\n      return `_v(${JSON.stringify(text)})`;\n    } else {\n      let tokens = [];\n      let match;\n      let lastIndex = 0;\n      defaultTagRE.lastIndex = 0;\n      while ((match = defaultTagRE.exec(text))) {\n        let index = match.index;\n        if (index > lastIndex) {\n          tokens.push(JSON.stringify(text.slice(lastIndex, index)));\n        }\n        tokens.push(`_s(${match[1].trim()})`);\n        lastIndex = index + match[0].length;\n      }\n      if (lastIndex < text.length) {\n        tokens.push(JSON.stringify(text.slice(lastIndex)));\n      }\n      return `_v(${tokens.join(\"+\")})`;\n    }\n  }\n}\nfunction genChildren(children) {\n  return children.map((child) => gen(child)).join(\",\");\n}\nfunction codegen(ast) {\n  let children = genChildren(ast.children);\n  let code = `_c('${ast.tag}',${\n    ast.attrs.length > 0 ? genProps(ast.attrs) : \"null\"\n  }${ast.children.length ? `,${children}` : \"\"})`;\n  return code;\n}\n\n// 对模版进行编译处理\nexport function compileToFunction(template) {\n  // 1.将 template 转化成 ast 语法树\n  let ast = parseHTML(template);\n\n  // 2.生成render方法，（render方法执行后的返回结果就是虚拟DOM）\n\n  // 模版引擎的实现原理---with + new Function\n  let code = codegen(ast);\n  // _c('div',{id:\"app\",style:{\"color\":\" red\",\" font-size\":\" 20px\"}},_c('div',{class:\"box\"},_v(\"a\"+_s(name)+\"b\")),_c('div',null,_v(_s(age))),_c('input',{type:\"text\"}))\n  code = `with(this){return ${code}}`;\n  let render = new Function(code); // 根据代码生成render函数\n\n  return render;\n}\n","let id = 0;\n\nclass Dep {\n  constructor() {\n    this.id = id++; // 属性的dep 要收集watcher\n    this.subs = []; // 存放当前属性对应的watcher有哪些\n  }\n\n  depend() {\n    // this.subs.push(Dep.target); // 会重复收集\n\n    Dep.target.addDep(this); // 让 watcher 记住 dep\n  }\n\n  addSub(watcher) {\n    this.subs.push(watcher);\n  }\n  notify() {\n    this.subs.forEach((watcher) => watcher.update()); // 告诉 watcher 要更新了\n  }\n}\nDep.target = null;\n\nlet stack = []\nexport function pushTarget(watcher){\n  stack.push(watcher);\n  Dep.target = watcher\n}\n\nexport function popTarget(){\n  stack.pop()\n  Dep.target = stack[stack.length - 1]\n}\n\nexport default Dep;\n","// 我们可以给模板中的属性增加一个收集器dep\n// 页面渲染的时候我们将渲染逻辑封装到watcher中   vm._update(vm._render())\n// dep记住这个watcher即可，稍后属性变化了可以到对应的dep中存放的watcher进行重新渲染\n// 观察者模式\n\nimport { popTarget, pushTarget } from \"./dep\";\n\nlet id = 0;\n\n// 不同的组件有不同的watcher\nclass Watcher {\n  constructor(vm, exprOrFn, options, cb) {\n    this.id = id++;\n\n    this.renderWatcher = options; // 是一个渲染watcher\n\n    if (typeof exprOrFn === \"string\") {\n      this.getter = function () {\n        return vm[exprOrFn];\n      };\n    } else {\n      this.getter = exprOrFn; // getter意味着调用这个函数可以发生取值\n    }\n\n    this.cb = cb;\n\n    this.deps = []; // 计算属性 ...... 其他清理工作\n\n    this.depsId = new Set();\n\n    this.lazy = options.lazy;\n    this.dirty = this.lazy; // 缓存值\n    this.vm = vm;\n    this.user = options.user; // 标识是否是用户的watcher\n\n    this.value = this.lazy ? undefined : this.get();\n  }\n  // 一个组件 对应多个属性 ，重复属性不用再记录\n  addDep(dep) {\n    let id = dep.id;\n    if (!this.depsId.has(id)) {\n      this.deps.push(dep);\n      this.depsId.add(id);\n      dep.addSub(this); // wather 已经记住了dep 并且去重了，此时让dep也记住watcher\n    }\n  }\n\n  evaluate() {\n    this.value = this.get(); // 获取到用户函数的返回值，并且标记为脏\n    this.dirty = false;\n  }\n\n  get() {\n    // Dep.target = this; // 静态属性\n    pushTarget(this);\n\n    let value = this.getter.call(this.vm); // 会去 vm 上取值\n\n    // Dep.target = null; // 渲染完 就清空\n    popTarget();\n\n    return value;\n  }\n\n  depend() {\n    let i = this.deps.length;\n    while (i--) {\n      this.deps[i].depend(); // 让计算属性watcher 也收集渲染wtcher\n    }\n  }\n\n  // 重新渲染\n  update() {\n    if (this.lazy) {\n      // 如果是计算属性，依赖的值变化了 就标识计算属性是脏值\n      this.dirty = true;\n    } else {\n      // this.get();\n      queueWatcher(this); // 把当前watcher暂存起来\n    }\n  }\n\n  run() {\n    let oldValue = this.value;\n    let newValue = this.get();\n    if (this.user) {\n      this.cb.call(this.vm, newValue, oldValue);\n    }\n  }\n}\n\nlet queue = [];\nlet has = {};\nlet pending = false; // 防抖\n\nfunction flushSchedulerQueue() {\n  let flushQueue = queue.slice(0);\n  queue = [];\n  has = {};\n  pending = false;\n  flushQueue.forEach((q) => q.run()); // 再刷新的过程中可能还有新的watcher,重新放大queue中\n}\n\nfunction queueWatcher(watcher) {\n  const id = watcher.id;\n  if (!has[id]) {\n    queue.push(watcher);\n    has[id] = true;\n    // 不管update 执行多少次，但是最终只执行一轮刷新\n    if (!pending) {\n      setTimeout(flushSchedulerQueue, 0);\n      pending = true;\n    }\n  }\n}\n\nlet callbacks = [];\nlet waiting = false;\n\nfunction flushCallbacks() {\n  let cbs = callbacks.slice(0);\n  console.log(cbs);\n  callbacks = [];\n  waiting = false;\n  cbs.forEach((cb) => cb()); // 按照顺序依次执行\n}\n\n//vue2-源码中 nextTick没有直接使用某个api而是采用优雅降级的方式\n//内部先采用的是promise（ie不兼容）---> Mutationobserver(h5的api) ---> 可以考虑ie专享的setImmediate ---> setTimeout\n\n// let timerFunc;\n// if (Promise) {\n//   console.log(1);\n//   //   timerFunc = () => {\n//   //     Promise.resolve().then(flushCallbacks);\n//   //   };\n//   var p_1 = Promise.resolve();\n//   timerFunc = function () {\n//     console.log(p_1);\n//     p_1.then(flushCallbacks);\n//   };\n// } else if (MutationObserver) {\n//   console.log(2);\n//   let observe = new MutationObserver(flushCallbacks); // 这里传入的回掉是异步执行的\n//   let textNode = document.createTextNode(1);\n//   observe.observe(textNode, {\n//     characterData: true,\n//   });\n//   timerFunc = () => {\n//     textNode.textContent = 2;\n//   };\n// } else if (setImmediate) {\n//   console.log(3);\n\n//   timerFunc = () => {\n//     setImmediate(flushCallbacks);\n//   };\n// } else {\n//   console.log(4);\n\n//   timerFunc = () => {\n//     setTimeout(flushCallbacks);\n//   };\n// }\n\nexport function nextTick(cb) {\n  callbacks.push(cb); // 维护nextTick中的callback方法\n  if (!waiting) {\n    // 最后一起刷新\n    setTimeout(flushCallbacks, 0); // ---> 好用\n    // Promise.resolve().then(flushCallbacks); // ---> 不好用（有bug,未解决,应该用这个）\n    // timerFunc(); // 做兼容性处理\n    waiting = true;\n  }\n}\n\n//需要给每个属性增加一个dep,目的就是收集watcher\n//一个组件中有多少个属性(n个属性会对应一个视图) n个dep对应一个watcher\n//1个属性对应着多个组件 1个dep对应多个watcher\n//多对多的关系\n\nexport default Watcher;\n","// h() _c()\nexport function createElementVNode(vm, tag, data, ...children) {\n  data = data ?? {};\n  let key = data.key;\n  if (key) {\n    delete data.key;\n  }\n  return vnode(vm, tag, key, data, children);\n}\n\n// _v()\nexport function createTextVNode(vm, text) {\n  return vnode(vm, undefined, undefined, undefined, undefined, text);\n}\n\nfunction vnode(vm, tag, key, data, children, text) {\n  return {\n    vm,\n    tag,\n    key,\n    data,\n    children,\n    text,\n  };\n}\n","import Watcher from \"./observe/watcher\";\nimport { createElementVNode, createTextVNode } from \"./vdom\";\nfunction createElm(vnode) {\n  let { tag, data, children, text } = vnode;\n  // 标签\n  if (typeof tag === \"string\") {\n    vnode.el = document.createElement(tag); // 将真实节点和虚拟节点对应起来\n    patchProps(vnode.el, data); // 属性\n    children.forEach((child) => {\n      vnode.el.appendChild(createElm(child));\n    });\n  } else {\n    vnode.el = document.createTextNode(text);\n  }\n  return vnode.el;\n}\nfunction patchProps(el, props) {\n  for (let key in props) {\n    if (key === \"style\") {\n      for (let styleName in props.style) {\n        el.style[styleName] = props.style[styleName];\n      }\n    } else {\n      el.setAttribute(key, props[key]);\n    }\n  }\n}\nfunction patch(oldVNode, vnode) {\n  // 初始化\n  const isRealElement = oldVNode.nodeType;\n  if (isRealElement) {\n    const elm = oldVNode; // 获取真实元素\n    const parentElm = elm.parentNode; // 拿到父元素\n    let newElm = createElm(vnode);\n    parentElm.insertBefore(newElm, elm.nextSibling);\n    parentElm.removeChild(elm); // 删除老节点\n\n    return newElm;\n  } else {\n    // diff\n  }\n}\n\nexport function initLifeCycle(Vue) {\n  // 虚拟DOM--->真实DOM\n  Vue.prototype._update = function (vnode) {\n    console.log(\"update\", vnode);\n\n    const vm = this;\n    const el = vm.$el;\n\n    // 初始化 && 更新\n    vm.$el = patch(el, vnode);\n  };\n\n  //_c('div',{},children:[])\n  Vue.prototype._c = function () {\n    return createElementVNode(this, ...arguments);\n  };\n\n  //_v(text)\n  Vue.prototype._v = function () {\n    return createTextVNode(this, ...arguments);\n  };\n\n  Vue.prototype._s = function (value) {\n    if (typeof value !== \"object\") return value;\n    return JSON.stringify(value);\n  };\n\n  Vue.prototype._render = function () {\n    const vm = this;\n    return vm.$options.render.call(vm); // 通过ast语法转译后生成的render方法\n  };\n}\nexport function mountComponent(vm, el) {\n  vm.$el = el;\n\n  // 1. 调用render方法产生虚拟节点 虚拟DOM\n\n  const updateCompontent = () => {\n    vm._update(vm._render()); // vm.$options.render 虚拟节点\n  };\n\n  console.log(new Watcher(vm, updateCompontent, true));\n\n  // 2. 根据虚拟DOM产生真实DOM\n  // 3. 插入到元素el\n}\n\n// vue核心流程\n// 1. 创造响应式数据\n// 2. 模板转换成ast语法树\n// 3. 将ast语法树转换成render函数\n// 4. 后续每次到数据更新只需要执行render函数（无需再执行ast转化过程）\n\n// render函数会产生虚拟节点（虚拟DOM）(使用响应式数据)\n// 根据生成的虚拟节点创造真实DOM\n\n\n// 调用钩子函数\nexport function callHook(vm, hook) {\n  const handles = vm.$options[hook];\n  if (handles) {\n    handles.forEach((handle) => handle.call(vm));\n  }\n}\n","// 重写数组的部分方法\n\nlet oldArrayProto = Array.prototype;\n\nexport let newArrayProto = Object.create(oldArrayProto);\n\n// 7种改变原数组的方法\n// concat、slice不改变原数组\nlet methods = [\"push\", \"pop\", \"shift\", \"unshift\", \"reverse\", \"sort\", \"splice\"];\n\nmethods.forEach((method) => {\n  // 重写数组方法\n  newArrayProto[method] = function (...args) {\n    const result = oldArrayProto[method].call(this, ...args); // 内部调用原来的方法、函数劫持（切片编程）\n\n    // 需要对新增的数据，再进行劫持\n    let inserted; // 新增的内容\n    let ob = this.__ob__;\n    switch (method) {\n      case \"push\":\n      case \"unshift\":\n        // arr.push(1,2,3)、 arr.unshift(4,5,6)\n        inserted = args;\n        break;\n\n      case \"splice\":\n        // arr.splice(1, 2, { a: 2 });\n        inserted = args.slice(2);\n        break;\n      default:\n        break;\n    }\n\n    if (inserted) {\n      // 对新增的内容再次进行观测\n      ob.observeArray(inserted);\n    }\n\n    ob.dep.notify(); // 数组变化了，通知对应的watcher\n    return result;\n  };\n});\n","import { newArrayProto } from \"./array\";\nimport Dep from \"./dep\";\n\nclass Observer {\n  constructor(data) {\n    //给每个对象都增加收集功能\n    this.dep = new Dep();\n\n    // Object.defineProperty只能劫持已经存在的属性（vue2为了解决这 单独写了一些API $set、$delete......）\n\n    Object.defineProperty(data, \"__ob__\", {\n      value: this,\n      enumerable: false, // 将__ob__变成不可枚举，（否则在walk()会进入死循环）\n    });\n    // data.__ob__ = this; // 1.通过__ob__访问方法属性、2.给数据添加了一个标识，存在__ob__证明劫持过了\n\n    // 判断是否为数组 - 单独处理\n    if (Array.isArray(data)) {\n      data.__proto__ = newArrayProto; // 重写数组的方法\n\n      this.observeArray(data); // 如果数组中放油对象，可以监听对象的变化\n    } else {\n      this.walk(data);\n    }\n  }\n  // 循环对象 对属性依次劫持\n  walk(data) {\n    // \"重新定义\" 属性---性能差\n    Object.keys(data).forEach((key) => defineReactive(data, key, data[key]));\n  }\n  observeArray(data) {\n    // 劫持数组 [1, 2, { a: 2 }]\n    data.forEach((item) => observe(item));\n  }\n}\n\n// 深层次嵌套会递归，递归多了性能差，不存在属性监控不到，存在的属性要重写方法\nfunction dependArray(value) {\n  for (let i = 0; i < value.length; i++) {\n    let current = value[i];\n    current.__ob__ && current.__ob__.dep.depend();\n    if (Array.isArray(current)) {\n      dependArray(current);\n    }\n  }\n}\n\n// 属性劫持（闭包应用）\nexport function defineReactive(target, key, value) {\n  // 如果 value 还是对象 递归。\n  let childOb = observe(value);\n  let dep = new Dep(); // 每个属性都有对应的dep\n  Object.defineProperty(target, key, {\n    // 取值的时候会触发 get\n    get() {\n      if (Dep.target) {\n        dep.depend(); // 让这个属性的收集器记住当前的watcher\n\n        if (childOb) {\n          // 让数组和对象本身也实现依赖收集\n          childOb.dep.depend();\n\n          if (Array.isArray(value)) {\n            dependArray(value);\n          }\n        }\n      }\n\n      return value;\n    },\n    // 修改的时候会触发 set\n    set(newValue) {\n      if (newValue === value) return;\n      observe(newValue); // 新值可能是 对象\n      value = newValue;\n      dep.notify(); // 通知更新\n    },\n  });\n}\n\nexport function observe(data) {\n  // 对 data 对象 进行 数据劫持\n\n  if (typeof data !== \"object\" || data == null) {\n    return; // 判断是不是对象\n  }\n  if (data.__ob__ instanceof Observer) {\n    // 这个对象被劫持过了\n    return data.__ob__;\n  }\n\n  //如果一个对象被劫持过了，就不需要再劫持了（要判断一个对象是否被劫持过，可以添加一个实例，用实例判断是否劫持过）\n  return new Observer(data);\n}\n","import { observe } from \"./observe\";\nimport Dep from \"./observe/dep\";\nimport Watcher from \"./observe/watcher\";\nexport function initState(vm) {\n  const ops = vm.$options; // 获取所有用户选项\n  if (ops.data) {\n    initDate(vm);\n  }\n  if (ops.computed) {\n    initComputed(vm);\n  }\n  if (ops.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initWatch(vm) {\n  let watch = vm.$options.watch;\n  for (let key in watch) {\n    const handler = watch[key]; // 字符串、数组、函数、（对象暂不实现）\n    if (Array.isArray(handler)) {\n      for (let i = 0; i < handler.length; i++) {\n        createWatcher(vm, key, handler[i]);\n      }\n    } else {\n      createWatcher(vm, key, handler);\n    }\n  }\n}\n\nfunction createWatcher(vm, key, handler) {\n  if (typeof handler === \"string\") {\n    handler = vm[handler];\n  } else {\n  }\n  return vm.$watch(key, handler);\n}\n\nfunction proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[target][key];\n    },\n    set(newValue) {\n      vm[target][key] = newValue;\n    },\n  });\n}\n\nfunction initDate(vm) {\n  let data = vm.$options.data; // data 可能是 函数 或 对象\n  data = typeof data === \"function\" ? data.call(vm) : data;\n\n  // 数据劫持 Object.defineProperty\n  observe(data);\n\n  vm._data = data; // 将返回的对象放到 _data 上\n\n  // 将 vm._data.XXX 代码为 vm.XXX\n  for (let key in data) {\n    proxy(vm, \"_data\", key);\n  }\n}\n\nfunction initComputed(vm) {\n  const computed = vm.$options.computed;\n  const watchers = (vm._computedWatchers = {}); // 将计算属性watcher保存到vm上\n  for (let key in computed) {\n    let userDef = computed[key];\n\n    let fn = typeof userDef === \"function\" ? userDef : userDef.get;\n    // 监控计算属性中get的变化\n    // 如果直接 new Watcher 默认就会执行，将属性和watchers对应起来\n    watchers[key] = new Watcher(vm, fn, { lazy: true });\n\n    defineComputed(vm, key, userDef);\n  }\n}\n\nfunction defineComputed(target, key, userDef) {\n  // const getter = typeof userDef === \"function\" ? userDef : userDef.get;\n  const setter = userDef.set || (() => {});\n\n  // 可以通过实例拿到对应属性\n  Object.defineProperty(target, key, {\n    get: createComputedGetter(key),\n    set: setter,\n  });\n}\n\n// 计算属性根本不会收集依赖，只会让自己的依赖属性去收集依赖\nfunction createComputedGetter(key) {\n  // 需要检测是否要执行这个getter\n  return function () {\n    const watcher = this._computedWatchers[key];\n    if (watcher.dirty) {\n      // 如果是脏的就去执行 用户传入的getter\n      watcher.evaluate(); // 求值后 dirty 变为了false,下次就不求值了\n    }\n    if (Dep.target) {\n      // 计算属性出栈后，还要渲染watcher,应该让计算属性的watcher里的属性 也去收集上层watcher\n      watcher.depend();\n    }\n    return watcher.value;\n  };\n}\n","import { compileToFunction } from \"./compiler\";\nimport { callHook, mountComponent } from \"./lifecycle\";\nimport { initState } from \"./state\";\nimport { mergeOptions } from \"./utils\";\n\n// Vue 的 init() 方法\nexport function initMixin(Vue) {\n  // 初始化\n  Vue.prototype._init = function (options) {\n    // options 用户配置\n    // $data、$attr、$nextTick ......\n    const vm = this;\n    // vm.$options = options; // 将用户选项挂载到实例上\n    vm.$options = mergeOptions(this.constructor.options, options); // 合并\n    console.log(vm.$options);\n\n    callHook(vm, \"beforeCreated\");\n\n    // 初始化状态\n    initState(vm);\n\n    callHook(vm, \"created\");\n\n    if (options.el) {\n      vm.$mount(options.el);\n    }\n  };\n\n  Vue.prototype.$mount = function (el) {\n    const vm = this;\n    const ops = vm.$options;\n    el = document.querySelector(el);\n    // 检查用户选项 有没有 render 函数\n    if (!ops.render) {\n      let template;\n      // 有没有 template 和 el\n      if (!ops.template && el) {\n        template = el.outerHTML;\n      } else {\n        if (el) {\n          template = ops.template; // 用户选项写了 template 用 template\n        }\n      }\n\n      if (template) {\n        // 对模版进行编译\n        const render = compileToFunction(template);\n        ops.render = render;\n      }\n    }\n\n    mountComponent(vm, el); // 组件的挂载\n    // ops.render; // 最终的render方法\n  };\n}\n","import { initGloablAPI } from \"./gloablAPI\";\nimport { initMixin } from \"./init\";\nimport { initLifeCycle } from \"./lifecycle\";\nimport Watcher, { nextTick } from \"./observe/watcher\";\n\n// 将所有的方法耦合在一起\nfunction Vue(options) {\n  // options 用户选项\n  this._init(options);\n}\nVue.prototype.$nextTick = nextTick;\n\nVue.prototype.$watch = function (exprOrFn, cb) {\n  console.log(exprOrFn, cb);\n  // 监听的值变化了，执行cb方法\n  new Watcher(this, exprOrFn, { user: true }, cb);\n};\n\ninitMixin(Vue); // 扩展了init方法\ninitLifeCycle(Vue);\ninitGloablAPI(Vue);\nexport default Vue;\n"],"names":["strats","LIFECYCLE","forEach","hook","p","c","concat","mergeOptions","parent","child","options","key","mergeFiled","hasOwnProperty","initGloablAPI","Vue","mixin","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","start","console","log","node","push","chars","text","replace","end","pop","length","advance","n","substring","parseStartTag","match","tagName","attr","name","value","textEnd","indexOf","startTagMatch","endTagMatch","genProps","str","i","obj","split","item","trim","JSON","stringify","slice","defaultTagRE","gen","codegen","test","tokens","lastIndex","exec","index","join","genChildren","map","ast","code","compileToFunction","template","render","Function","id","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","Watcher","vm","exprOrFn","cb","renderWatcher","getter","deps","depsId","Set","lazy","dirty","user","undefined","get","dep","has","add","addSub","call","depend","queueWatcher","oldValue","newValue","queue","pending","flushSchedulerQueue","flushQueue","q","run","setTimeout","callbacks","waiting","flushCallbacks","cbs","nextTick","createElementVNode","data","vnode","createTextVNode","createElm","el","document","createElement","patchProps","appendChild","createTextNode","props","styleName","style","setAttribute","patch","oldVNode","isRealElement","nodeType","elm","parentElm","parentNode","newElm","insertBefore","nextSibling","removeChild","initLifeCycle","prototype","_update","$el","_c","arguments","_v","_s","_render","$options","mountComponent","updateCompontent","callHook","handles","handle","oldArrayProto","Array","newArrayProto","Object","create","methods","method","args","result","inserted","ob","__ob__","observeArray","notify","Observer","defineProperty","enumerable","isArray","__proto__","walk","keys","defineReactive","observe","dependArray","current","childOb","set","initState","ops","initDate","computed","initComputed","watch","initWatch","handler","createWatcher","$watch","proxy","_data","watchers","_computedWatchers","userDef","fn","defineComputed","setter","createComputedGetter","evaluate","initMixin","_init","constructor","$mount","querySelector","outerHTML","$nextTick"],"mappings":"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"}